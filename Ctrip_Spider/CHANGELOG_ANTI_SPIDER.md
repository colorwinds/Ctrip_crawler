# åçˆ¬è™«ç­–ç•¥å¢å¼ºæ›´æ–°æ—¥å¿—

## ğŸ“… æ›´æ–°æ—¥æœŸ
2025-12-27

## ğŸ¯ æ›´æ–°æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°ä¸ºé¡¹ç›®æ·»åŠ äº†å®Œæ•´çš„åçˆ¬è™«ç­–ç•¥æ”¯æŒï¼ŒåŒ…æ‹¬User-Agentè½®æ¢ã€ä»£ç†æ± ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## âœ¨ æ–°å¢åŠŸèƒ½

### 1. æ ¸å¿ƒæ¨¡å—

#### `anti_spider.py` - åçˆ¬è™«ç­–ç•¥æ ¸å¿ƒæ¨¡å—
- âœ… **UserAgentPool**: User-Agentæ± ç®¡ç†ç±»
  - å†…ç½®20+ä¸ªå¸¸è§User-Agent
  - æ”¯æŒéšæœºå’Œè½®è¯¢ä¸¤ç§è½®æ¢æ¨¡å¼
  - ä½¿ç”¨ç»Ÿè®¡åŠŸèƒ½
  
- âœ… **ProxyPool**: ä»£ç†æ± ç®¡ç†ç±»
  - ä»£ç†å¥åº·æ£€æŸ¥
  - è‡ªåŠ¨æ ‡è®°å¤±è´¥ä»£ç†
  - æ”¯æŒHTTP/HTTPS/SOCKS5ä»£ç†
  - ä»£ç†ä½¿ç”¨ç»Ÿè®¡å’ŒçŠ¶æ€ç®¡ç†
  
- âœ… **EnhancedRequestOptimizer**: å¢å¼ºçš„è¯·æ±‚ä¼˜åŒ–å™¨
  - é›†æˆUser-Agentè½®æ¢
  - é›†æˆä»£ç†æ± ç®¡ç†
  - è‡ªåŠ¨å»¶è¿Ÿæ§åˆ¶
  - ç»Ÿä¸€çš„è¯·æ±‚æ¥å£

### 2. é…ç½®æ–‡ä»¶

#### `config.py` - ç»Ÿä¸€é…ç½®ç®¡ç†
- å»¶è¿Ÿé…ç½®
- User-Agenté…ç½®
- ä»£ç†é…ç½®
- è¯·æ±‚é…ç½®
- æ—¥å¿—é…ç½®
- è¾“å‡ºé…ç½®

### 3. æ–‡æ¡£å’Œç¤ºä¾‹

#### `ANTI_SPIDER_README.md` - ä½¿ç”¨æŒ‡å—
- åŠŸèƒ½ç‰¹æ€§è¯´æ˜
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- è¯¦ç»†ä½¿ç”¨è¯´æ˜
- é…ç½®å‚æ•°è¯´æ˜
- é—®é¢˜æ’æŸ¥æŒ‡å—

#### `example_anti_spider.py` - ä½¿ç”¨ç¤ºä¾‹
- User-Agentè½®æ¢ç¤ºä¾‹
- ä»£ç†æ± ç®¡ç†ç¤ºä¾‹
- å„æ¨¡å—é›†æˆç¤ºä¾‹
- ç»Ÿè®¡ä¿¡æ¯æŸ¥çœ‹ç¤ºä¾‹

## ğŸ”„ æ›´æ–°çš„æ¨¡å—

### 1. `sight_id.py` - æ™¯ç‚¹IDæœç´¢å™¨
**æ›´æ–°å†…å®¹:**
- âœ… é›†æˆ `EnhancedRequestOptimizer`
- âœ… æ”¯æŒUser-Agentè½®æ¢
- âœ… æ”¯æŒä»£ç†é…ç½®
- âœ… è‡ªåŠ¨å»¶è¿Ÿæ§åˆ¶

**ä½¿ç”¨æ–¹å¼:**
```python
sight_id_searcher = SightId(
    delay_range=(1, 3),
    proxies=proxies,  # å¯é€‰
    use_proxy=False,  # å¯é€‰
    use_user_agent_rotation=True,  # æ¨èå¯ç”¨
    logger=logger
)
```

### 2. `sight_list.py` - æ™¯ç‚¹åˆ—è¡¨çˆ¬å–å™¨
**æ›´æ–°å†…å®¹:**
- âœ… é›†æˆ `EnhancedRequestOptimizer`
- âœ… æ”¯æŒUser-Agentè½®æ¢
- âœ… æ”¯æŒä»£ç†é…ç½®
- âœ… è‡ªåŠ¨å»¶è¿Ÿæ§åˆ¶

**ä½¿ç”¨æ–¹å¼:**
```python
scraper = CtripAttractionScraper(
    timeout=10,
    delay_range=(1, 3),
    proxies=proxies,  # å¯é€‰
    use_proxy=False,  # å¯é€‰
    use_user_agent_rotation=True,  # æ¨èå¯ç”¨
    logger=logger
)
```

### 3. `sight_detail.py` - æ™¯ç‚¹è¯¦æƒ…è·å–å™¨
**æ›´æ–°å†…å®¹:**
- âœ… é›†æˆ `EnhancedRequestOptimizer`
- âœ… æ”¯æŒUser-Agentè½®æ¢
- âœ… æ”¯æŒä»£ç†é…ç½®
- âœ… è‡ªåŠ¨å»¶è¿Ÿæ§åˆ¶

**ä½¿ç”¨æ–¹å¼:**
```python
detail_fetcher = AttractionDetailFetcher(
    delay_range=(1, 3),
    proxies=proxies,  # å¯é€‰
    use_proxy=False,  # å¯é€‰
    use_user_agent_rotation=True,  # æ¨èå¯ç”¨
    logger=logger
)
```

### 4. `sight_comments.py` - è¯„è®ºçˆ¬è™«
**æ›´æ–°å†…å®¹:**
- âœ… é›†æˆ `EnhancedRequestOptimizer`
- âœ… æ”¯æŒUser-Agentè½®æ¢
- âœ… æ”¯æŒä»£ç†é…ç½®
- âœ… è‡ªåŠ¨å»¶è¿Ÿæ§åˆ¶
- âœ… é¡µé¢é—´å»¶è¿Ÿä¼˜åŒ–

**ä½¿ç”¨æ–¹å¼:**
```python
comment_spider = CtripCommentSpider(
    output_dir='./Datasets',
    delay_range=(1, 3),
    proxies=proxies,  # å¯é€‰
    use_proxy=False,  # å¯é€‰
    use_user_agent_rotation=True,  # æ¨èå¯ç”¨
    logger=logger
)
```

### 5. `request_optimizer.py` - è¯·æ±‚ä¼˜åŒ–å™¨ï¼ˆå‘åå…¼å®¹ï¼‰
**æ›´æ–°å†…å®¹:**
- âœ… ä¿æŒå‘åå…¼å®¹
- âœ… æ·»åŠ æ–°æ¨¡å—å¯¼å…¥æç¤º
- âœ… æ¨èä½¿ç”¨ `EnhancedRequestOptimizer`

## ğŸ“Š åŠŸèƒ½å¯¹æ¯”

| åŠŸèƒ½ | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ |
|------|--------|--------|
| User-Agentè½®æ¢ | âŒ | âœ… |
| ä»£ç†æ± ç®¡ç† | âš ï¸ åŸºç¡€æ”¯æŒ | âœ… å®Œæ•´æ”¯æŒ |
| ä»£ç†å¥åº·æ£€æŸ¥ | âŒ | âœ… |
| å»¶è¿Ÿæ§åˆ¶ | âœ… | âœ… å¢å¼º |
| ä½¿ç”¨ç»Ÿè®¡ | âŒ | âœ… |
| é…ç½®ç®¡ç† | âŒ | âœ… |

## ğŸš€ è¿ç§»æŒ‡å—

### ä»æ—§ç‰ˆæœ¬è¿ç§»

#### æ—§ä»£ç :
```python
from sight_id import SightId

sight_id_searcher = SightId(
    delay_range=(1, 3),
    logger=logger
)
```

#### æ–°ä»£ç ï¼ˆæ¨èï¼‰:
```python
from sight_id import SightId

sight_id_searcher = SightId(
    delay_range=(1, 3),
    use_user_agent_rotation=True,  # æ–°å¢ï¼šå¯ç”¨User-Agentè½®æ¢
    logger=logger
)
```

### å¯ç”¨ä»£ç†

```python
proxies = [
    'http://proxy1.example.com:8080',
    'http://proxy2.example.com:8080',
]

sight_id_searcher = SightId(
    delay_range=(1, 3),
    proxies=proxies,  # æ–°å¢ï¼šä»£ç†åˆ—è¡¨
    use_proxy=True,  # æ–°å¢ï¼šå¯ç”¨ä»£ç†
    use_user_agent_rotation=True,
    logger=logger
)
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

1. **æ™ºèƒ½å»¶è¿Ÿ**: æ ¹æ®è¯·æ±‚ç±»å‹è‡ªåŠ¨è°ƒæ•´å»¶è¿Ÿ
2. **ä»£ç†è½®æ¢**: è‡ªåŠ¨é€‰æ‹©æœ€ä½³ä»£ç†
3. **å¤±è´¥é‡è¯•**: è‡ªåŠ¨æ ‡è®°å¤±è´¥ä»£ç†ï¼Œé¿å…é‡å¤ä½¿ç”¨
4. **ç»Ÿè®¡ç›‘æ§**: å®æ—¶ç›‘æ§è¯·æ±‚å’Œä»£ç†çŠ¶æ€

## ğŸ”’ å®‰å…¨æ€§å¢å¼º

1. **User-Agentå¤šæ ·åŒ–**: é™ä½è¢«è¯†åˆ«ä¸ºçˆ¬è™«çš„é£é™©
2. **ä»£ç†æ”¯æŒ**: éšè—çœŸå®IPåœ°å€
3. **è¯·æ±‚é¢‘ç‡æ§åˆ¶**: é¿å…å¯¹æœåŠ¡å™¨é€ æˆè¿‡å¤§å‹åŠ›
4. **é”™è¯¯å¤„ç†**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å‘åå…¼å®¹**: æ‰€æœ‰æ—§ä»£ç ä»ç„¶å¯ä»¥æ­£å¸¸å·¥ä½œ
2. **é»˜è®¤è¡Œä¸º**: é»˜è®¤å¯ç”¨User-Agentè½®æ¢ï¼Œä¸å¯ç”¨ä»£ç†
3. **é…ç½®ä¼˜å…ˆ**: å¯ä»¥é€šè¿‡ `config.py` ç»Ÿä¸€ç®¡ç†é…ç½®
4. **æ—¥å¿—è®°å½•**: æ‰€æœ‰æ“ä½œéƒ½ä¼šè®°å½•åˆ°æ—¥å¿—æ–‡ä»¶

## ğŸ› å·²çŸ¥é—®é¢˜

æ— 

## ğŸ”® æœªæ¥è®¡åˆ’

- [ ] æ·»åŠ Cookieç®¡ç†åŠŸèƒ½
- [ ] æ·»åŠ è¯·æ±‚é‡è¯•æœºåˆ¶
- [ ] æ·»åŠ è¯·æ±‚é˜Ÿåˆ—ç®¡ç†
- [ ] æ·»åŠ åˆ†å¸ƒå¼çˆ¬è™«æ”¯æŒ
- [ ] æ·»åŠ æ›´å¤šåçˆ¬è™«ç­–ç•¥

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ï¼š
- `ANTI_SPIDER_README.md` - è¯¦ç»†ä½¿ç”¨æŒ‡å—
- `example_anti_spider.py` - ä½¿ç”¨ç¤ºä¾‹
- æ—¥å¿—æ–‡ä»¶ - é”™è¯¯æ’æŸ¥

